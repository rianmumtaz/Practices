/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[15],{370:function(ha,ca,f){function aa(e,f,h){f.endsWith("/")||(f+="/");h=h||{};var n=h.disableWebsockets||!1;this.HT=h.singleServerMode||!1;null!=h.customQueryParameters&&Object(r.b)("wvsQueryParameters",h.customQueryParameters);f.endsWith("blackbox/")||(f+="blackbox/");this.bn=h.uploadData||null;this.pw=h.uriData||null;this.IM=h.cacheKey||null;this.nE=Object(x.a)(f,null,n);this.Sf=f;this.FE=e;this.tf=null;this.bi=z();this.bm=z();
this.wy=!1;this.dg=this.Wd=this.ne=this.$e=null;this.zf=[];this.ez=[];this.cache={};this.timeStamp=0;this.Of=[];this.dh=[];this.aF=null;this.xE=!1;this.lI=this.id=null;this.TG=this.tP=fa;this.mB=0;this.bG=!1;this.H7=1;this.sA={};this.Hz=null;this.Wr(!0)}function z(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,Ro:function(){return 1===(e.state&1)},D6:function(){return 2===(e.state&2)},Xh:function(){return!e.D6()&&!e.Ro()},j6:function(){return 4===(e.state&4)},XS:function(){e.state|=
4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function fa(){return!1}function da(e,f,h){if(!(f in ea))return!0;f=ea[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var x=h;if(w.name in r){var y="",z=!1;r=r[w.name];switch(w.type){case "s":y="String";z=Object(ba.isString)(r);break;case "a":y="Array";z=Object(ba.isArray)(r);
break;case "n":y="Number";z=Object(ba.isNumber)(r)&&Object(ba.isFinite)(r);break;case "o":y="Object",z=Object(ba.isObject)(r)&&!Object(ba.isArray)(r)}z||x.reject('Expected response field "'+w.name+'" to have type '+y);w=z}else x.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}f.r(ca);var ba=f(0);f.n(ba);var y=f(1);ha=f(46);var n=f(31),x=f(388),h=f(79),e=f(313),w=f(125),r=f(40),ia=f(137),ea={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",
type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};aa.prototype=Object(ba.extend)(aa.prototype,{o0:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",e.Sf+"ck");n.withCredentials=
e.Go();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};n.send()})},bba:function(e,f){this.tP=e||fa;this.TG=f||fa},YM:function(){var e=this;this.bm=z();this.bi=z();return this.nE.RE().then(function(){e.wy=!1;e.id=null;e.xE=!1;return e.o0()})},$H:function(){this.tP();this.Vz();this.$e&&(this.$e.Xh()?this.uf(this.$e.request):this.$e.Ro()&&this.TG(this.$e.result.url,"pdf")&&(this.$e=null,this.xS()));this.dg&&this.dg.Xh()&&this.uf(this.dg.request);this.ne&&
this.ne.Xh()?this.uf(this.ne.request):this.Wd&&this.Wd.Xh()&&this.iP(this.Wd.request);var e;for(e=0;e<this.Of.length;e++)this.Of[e]&&this.Of[e]&&(this.Of[e].Xh()?this.uf(this.Of[e].request):this.Of[e].Ro()&&this.TG(this.Of[e].result.url,"image")&&(this.Of[e]=null,this.kB(e)));for(e=0;e<this.dh.length;e++)this.dh[e]&&this.dh[e]&&this.dh[e].Xh()&&!this.dh[e].j6()&&this.uf(this.dh[e].request);for(e=0;e<this.zf.length;e++)this.zf[e]&&this.zf[e].Xh()&&this.uf(this.zf[e].request)},Vz:function(e){var f=
this;this.wy||(this.timeStamp=Date.now(),this.nE.QI(function(e){f.V7(e)},function(){return null},function(){return null},!0).then(function(){clearInterval(f.bB);f.bB=null},function(h){f.wy=!1;if(!f.bB){var n=0;f.xE=!0;f.lI=0;f.bB=setInterval(function(){2>n++?f.$H():(clearInterval(f.bB),e&&e.reject(w.a),Object(y.f)("WebViewerServer connection failed:"+h))},5E3)}}),this.wy=!0)},jda:function(){var e=this,f=createPromiseCapability();if(this.bn){var h=new FormData;h.append("file",this.bn.fileHandle,this.bn.fileHandle.name);
var r=this.bn.loadCallback;var w="upload";var x=this.bn.extension}else if(this.pw){h={uri:this.pw.uri,cha:this.pw.shareId};h=Object.keys(h).map(function(e){return e+"="+(h[e]?encodeURIComponent(h[e]):"")}).join("&");var y="application/x-www-form-urlencoded; charset=UTF-8";r=this.pw.loadCallback;w="url";x=this.pw.extension}else return Promise.resolve();var z=new XMLHttpRequest,aa=Object(n.i)(e.Sf,"AuxUpload");aa=Object(ia.a)(aa)+"&type="+w+"&ext="+x;z.open("POST",aa);z.withCredentials=this.Go();y&&
z.setRequestHeader("Content-Type",y);z.addEventListener("load",function(){if(z.readyState===z.DONE&&200===z.status){var h=JSON.parse(z.response);e.FE=h.uri;r(h);f.resolve(h)}});z.addEventListener("error",function(){f.reject(z.statusText+" "+JSON.stringify(z))});this.bn&&null!=this.bn.onProgress&&(z.upload.onprogress=function(f){e.bn.onProgress(f)});z.send(h);return f.promise},tba:function(e){this.Hz=e},m5:function(e){this.password&&this.bi.Ro()?e(this.password):this.Hz(e)},L$:function(e){this.password=
e||null;this.bi.Ro()||(this.Vz(this.bi),this.uf({t:"pages"}));return this.bi.promise},Jv:function(e){this.aF=e||null;this.bi.Ro()||(this.Vz(this.bi),this.uf({t:"pages"}));return this.bi.promise},$M:function(e){e=Object.assign(e,{uri:encodeURIComponent(this.FE)});this.aF&&(e.ext=this.aF);this.tf&&(e.c=this.tf);this.password&&(e.pswd=this.password);this.IM&&(e.cacheKey=this.IM);return e},uf:function(e){e=this.$M(e);this.nE.send(e)},pk:function(e){return e},V7:function(e){var f=this,n=e.data,w=e.err,
x=e.t;if(w&&f.Hz&&"This document could not be decrypted with the given password"===w)f.Hz(function(e){f.L$(e)});else switch(x){case "upload":w?f.kda.reject(w):f.kda.resolve("Success");break;case "pages":w?f.bi.reject(w):da(n,x,f.bi)&&f.bi.resolve(n);break;case "config":w?f.bm.reject(w):da(n,x,f.bm)&&(n.id&&(f.id=n.id),n.auth&&(e=Object(r.a)("wvsQueryParameters"),e.auth=n.auth,Object(r.b)("wvsQueryParameters",e)),n.serverVersion&&(f.Dda=n.serverVersion,Object(y.g)("[WebViewer Server] server version: "+
f.Dda)),n.serverID?(f.mB=n.serverID===f.lI&&f.bG?f.mB+1:0,f.lI=n.serverID):f.mB=0,f.bG=!1,f.bm.resolve(n));break;case "health":w?f.bm.reject(w):da(n,x,f.bm)&&(n=n.unhealthy,f.HT&&n?Object(y.i)("Server failed health check. Single server mode ignoring check."):!f.pfa&&n&&1>=f.mB&&(f.bG=!0,f.YM().then(function(){f.$H()},function(){f.$H()})));break;case "pdf":n.url=Object(ia.a)(f.Sf+"../"+encodeURI(n.url));w?f.$e.reject(w):da(n,x,f.$e)&&f.$e.resolve(n);break;case "docmod":n.url=Object(ia.a)(f.Sf+"../"+
encodeURI(n.url));w?f.sA[n.rID].reject(w):da(n,x,f.$e)&&f.sA[n.rID].resolve(n);break;case "xod":if(w)this.ne&&this.ne.Xh()&&this.ne.reject(w),this.Wd&&this.Wd.Xh()&&this.Wd.reject(w);else if(n.notFound)n.noCreate||this.ne&&this.ne.Xh()&&this.ne.resolve(n),this.Wd&&this.Wd.Xh()&&this.Wd.resolve(n);else{n.url&&(n.url=Object(ia.a)(f.Sf+"../"+encodeURI(n.url)));if(!this.Wd||this.Wd.Ro())this.Wd=z(),this.Wd.request={t:"xod",noCreate:!0};this.ne||(this.ne=z(),this.ne.request={t:"xod"});this.Wd.resolve(n);
this.ne.resolve(n)}break;case "annots":if(w)f.dg.reject(w);else if(da(n,x,f.dg)){f.dg.XS();var aa=new XMLHttpRequest;e=f.Sf+"../"+encodeURI(n.url);var ba=n.hasAppearance?Object(ia.a)(e+".xodapp"):null;aa.open("GET",Object(ia.a)(e));aa.responseType="text";aa.withCredentials=this.Go();aa.addEventListener("load",function(){aa.readyState===aa.DONE&&200===aa.status&&f.dg.resolve({lJ:aa.response,uM:ba})});aa.addEventListener("error",function(){f.dg.reject(aa.statusText+" "+JSON.stringify(aa))});aa.send()}break;
case "image":var ca=this.Of[n.p];w?ca.promise.reject(w):da(n,x,ca)&&(ca.result=n,ca.result.url=Object(ia.a)(f.Sf+"../"+encodeURI(ca.result.url)),ca.resolve(ca.result));break;case "tiles":ca=n.rID;e=this.zf[ca];this.zf[ca]=null;this.ez.push(ca);if(w)e.reject(w);else if(da(n,x,e)){for(w=0;w<n.tiles.length;w++)n.tiles[w]=Object(ia.a)(f.Sf+"../"+encodeURI(n.tiles[w]));e.resolve(n)}break;case "text":ca=this.dh[n.p];if(w)ca.reject(w);else if(da(n,x,ca)){ca.XS();var ea=new XMLHttpRequest;n=Object(ia.a)(f.Sf+
"../"+encodeURI(n.url));ea.open("GET",n);ea.withCredentials=this.Go();ea.addEventListener("load",function(){ea.readyState===ea.DONE&&200===ea.status&&(ca.result=JSON.parse(ea.response),ca.resolve(ca.result))});ea.addEventListener("error",function(e){ca.reject(ea.statusText+" "+JSON.stringify(e))});ea.send()}break;case "progress":"loading"===n.t&&f.trigger(h.a.Events.DOCUMENT_LOADING_PROGRESS,[n.bytes,n.total])}},sO:function(){this.Vz(this.bm);return this.bm.promise},o3:function(){this.dg||(this.dg=
z(),this.dg.request={t:"annots"},this.uf(this.dg.request));return this.dg.promise},kB:function(e){this.Of[e]||(this.Of[e]=z(),this.Of[e].request={t:"image",p:e},this.uf(this.Of[e].request));return this.Of[e].promise},M$:function(e){this.dh[e]||(this.dh[e]=z(),this.dh[e].request={t:"text",p:e},this.uf(this.dh[e].request));return this.dh[e].promise},N$:function(e,f,h,n){var r=this.zf.length;this.ez.length&&(r=this.ez.pop());this.zf[r]=z();this.zf[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.uf(this.zf[r].request);
return this.zf[r].promise},xS:function(){this.$e||(this.$e=z(),this.$e.request={t:"pdf"},this.xE?this.$e.resolve({url:this.FE}):this.uf(this.$e.request));return this.$e.promise},JO:function(e){var f=this,h=new XMLHttpRequest,n=Object(ia.a)(this.Sf+"aul")+"&id="+this.id,r=new FormData,w={};e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.H7++,parts:w};e.print&&(w.print=!0);var x=this.$M(w);r.append("msg",JSON.stringify(x));
return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],y=e[1],aa=e[2];w&&r.append("annots",w);y&&r.append("watermark",e.watermark);aa&&r.append("redactions",aa);f.sA[x.reqID]=z();h.open("POST",n);h.withCredentials=f.Go;e=new Promise(function(e,f){h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e():f("An error occurred while sending down annotation data to the server"))}});h.send(r);return e.then(function(){return f.sA[x.reqID].promise})})},
iP:function(){this.Wd||(this.Wd=z(),this.Wd.request={t:"xod",noCreate:!0},this.uf(this.Wd.request));return this.Wd.promise},O$:function(){this.ne||(this.ne=z(),this.ne.request={t:"xod"},this.uf(this.ne.request));return this.ne.promise},Om:function(){return!0},request:function(){},TR:function(){},abort:function(){for(var e=0;e<this.zf.length;e++)this.zf[e]&&(this.zf[e].resolve(null),this.zf[e]=null,this.ez.push(e));this.close()},wB:function(e){this.tf=this.tf||{};this.tf.headers=e},Nfa:function(){return this.tf?
Object(ba.omit)(this.tf.headers,["Cookie","cookie"]):null},Wr:function(e){this.tf=this.tf||{};this.tf.internal=this.tf.internal||{};this.tf.internal.withCredentials=e},Go:function(){return this.tf&&this.tf.internal?this.tf.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ha.a)(aa);Object(e.a)(aa);Object(e.b)(aa);ca["default"]=aa},388:function(ha,ca,f){function aa(f,n,x){function h(e,f){function h(e){r().then(function(f){ca&&!ha?setTimeout(function(){h(e)},1):
f.send(JSON.stringify(e))})}function n(e,f,n,r){var ea=window.createPromiseCapability(),ia=!1,ja=ea;y=e;z=f;aa=n;x=null;r&&(e=Object(da.a)("wvsQueryParameters"),e.bcid=Object(fa.j)(8),Object(da.b)("wvsQueryParameters",e));try{e=Ca?qa+"/"+Ca:qa+"/ws";e=Object(ba.a)(e);var ka=new WebSocket(e);ka.onopen=function(){ea.resolve();ia=!0;ea=null;ca=!1;w.resolve(ka);z&&z()};ka.onerror=function(e){ca=ha=!0;ea&&ea.reject(e);x&&x.reject()};ka.onclose=function(){w=window.createPromiseCapability();ca=!0;x||(x=
window.createPromiseCapability());x.resolve();aa&&aa();y&&ia&&y({t:"health",data:{unhealthy:!0,isDead:!0}})};ka.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?h({hb:!0}):e.end?close():y(e))}}catch(Ea){ea.reject(Ea),ea=null}return ja.promise}function r(){ca&&y&&n(y);return w.promise}var w=window.createPromiseCapability(),x=null,y,z,aa=null,ca=!1,ha=!1,Ca=f,qa=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);return h+
e.slice(f,n)}(e);return{send:h,QI:n,RE:function(){return x?x.promise:r().then(function(e){x=window.createPromiseCapability();y=null;e.close();return x.promise})}}}function e(e){var f=e.lastIndexOf("/");0>f&&(f=e.length);return e.slice(0,f)}return window.WebSocket&&!x?h(f,n):function(f,h){function n(e){(ca?ca.promise:Promise.resolve(da)).then(function(f){var h=new XMLHttpRequest,n=aa?y+"/"+aa+"pf":y+"/pf";n=Object(ba.a)(n)+"&id="+f;f=new FormData;f.append("data",JSON.stringify(e));h.open("POST",n);
h.withCredentials=!0;h.send(f)})}function r(){da=0;ca||(ca=window.createPromiseCapability())}function w(){x=new XMLHttpRequest;var e=y+"/pf";e+=0!==da?"?id="+da+"&uc="+qa:"?uc="+qa;qa++;x.open("GET",e,!0);x.withCredentials=!0;x.setRequestHeader("Cache-Control","no-cache");x.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=x,h=!1;x.onreadystatechange=function(){a:if(3<=f.readyState&&!h){try{var e=f.responseText.length}catch(Aa){Object(z.g)("caught exception");break a}if(0<e)try{var x=f.responseText.split("\n");
for(x[x.length-1]&&x.pop();0<x.length&&3>x[x.length-1].length;)"]"===x.pop()&&r();0<x.length&&3>x[0].length&&x.shift();for(e=0;e<x.length;++e)x[e].endsWith(",")&&(x[e]=x[e].substr(0,x[e].length-1));0===da&&0<x.length&&(da=JSON.parse(x.shift()).id,e=ca,ca=null,e.resolve(da));var y;for(e=0;e<x.length;++e)(y=JSON.parse(x[e]))&&y.end?close():y&&y.hb&&y.id===da?n({hb:!0}):Ca(y)}catch(Aa){}fa||(h=!0,w())}};x.send()}var x,y=e(f),aa=h,da=0,ca=window.createPromiseCapability(),fa=!1,ha=null,Ca=null,qa=0;return{send:n,
QI:function(e,f,h){Ca=e;ha=h;fa=!1;r();w();f&&f();return Promise.resolve()},RE:function(){r();Ca=null;fa=!0;ha&&ha();x.abort();return Promise.resolve()}}}(f,n)}f.d(ca,"a",function(){return aa});var z=f(1),fa=f(31),da=f(40),ba=f(137)}}]);}).call(this || window)
